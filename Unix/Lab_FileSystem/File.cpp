//////////////////////////////////////////////////////////////////////////
#include "File.h"
//////////////////////////////////////////////////////////////////////////
using namespace NFileSystem;
//////////////////////////////////////////////////////////////////////////
CFile::CFile(ST_INODE* pINode, CFileSystem* pFS)
{
	m_pINode = pINode;
	m_pFS = pFS;
	m_dwSeekOffset = 0;
}
//////////////////////////////////////////////////////////////////////////
CFile::~CFile(void)
{

}
//////////////////////////////////////////////////////////////////////////
void CFile::Seek(DWORD dwPos)
{
	if (dwPos > m_pINode->dwFileSize)
		throw string("Invalid seek position");

	m_dwSeekOffset = dwPos;
}
//////////////////////////////////////////////////////////////////////////
DWORD CFile::Read(void* pData, DWORD dwSize)
{
	DWORD dwRead = m_pFS->ReadFile(m_pINode, pData, dwSize, m_dwSeekOffset);

	m_dwSeekOffset += dwRead;

	return dwRead;
}
//////////////////////////////////////////////////////////////////////////
void  CFile::Write(const void* pData, DWORD dwSize)
{
	m_pFS->WriteFile(m_pINode, pData, dwSize, m_dwSeekOffset);
	m_dwSeekOffset += dwSize;
}
//////////////////////////////////////////////////////////////////////////
bool CFile::Eof()
{
	return m_dwSeekOffset == m_pINode->dwFileSize;
}
//////////////////////////////////////////////////////////////////////////
